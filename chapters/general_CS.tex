
\chapter{压缩感知与基于压缩感知的信道估计}
信号处理中，传统的奈奎斯特（Nyquist）采样理论要求信号的采样频率必须大于等于信道带宽的两倍，采样获取大量数据，同时也包含了大量冗余信息。这极大的限制了高速信号处理发展要求。

2006年，Donoho等发表题为“Compressed Sensing”的文章，标志着压缩感知理论框架正式被提出。对于稀疏信号或者可以稀疏表示的信号，信号本身是可以压缩的，压缩感知理论可以通过远低于奈奎斯特采样定律的采样点，通过合适的重建算法，准确的恢复出原始信号。

其后，压缩感知理论在图像处理，信号处理，通信，人工智能等领域得到了广泛的应用。

\section{欠定线性系统及稀疏解}

\subsection{欠定线性系统}
对于线性方程组$\mathbf{Ax}=\mathbf{b}$，当矩阵${\mathbf{A}} \in {{\mathbf{R}}^{n \times m}}$ 且$n<m$ 时，称为欠定线性系统。在系统中，未知数个数大于方程数。由线性代数知，当$\mathbf{b}$ 不在矩阵$\mathbf{A}$ 列向量张成的空间中时，方程组无解；否则，有无穷多解。

\subsection{正则化}
对于欠定线性系统，我们只考虑有解的情况。为了能够得到确定的解，可以向线性系统增加条件，最常用的加条件方法就是正则化（regularization），即引入一个对解$\mathbf{x}$进行评价的函数 ，并期望其值越小越好。因此，欠定线性系统可以转化为如下的优化问题：
\begin{equation}
\begin{aligned}
& \min_x J(\mathbf{x}) \\
\texttt{s}.\texttt{t}. & \quad \mathbf{b} = \mathbf{Ax}
\end{aligned}
\end{equation}

最常用的$J(\mathbf{x})$为$\mathbf{x}$的2范数的平方$\mathop {\left\| {\mathbf{x}} \right\|}\nolimits_2^2$。 对于$J(\mathbf{x}) = \mathop {\left\| {\mathbf{x}} \right\|}\nolimits_2^2$ 的优化问题，可以使用拉格朗日数乘法得到确定的唯一解。
\begin{equation}
L(\mathbf{x}) = \mathop {\left\| {\mathbf{x}} \right\|}\nolimits_2^2 + \mathbf{\lambda}^T(\mathbf{b=Ax})
\end{equation}

事实上，对于任意的严格凸的函数作为$J(\bullet)$，都能保证解的唯一性。

\subsection{稀疏解}
对于以$l_p-$范数作为$J(\mathbf{x})$，相比于$p>1$，$p \le 1$时具有让解变得稀疏的倾向，即$\mathbf{x}$ 中非零项更少。这种趋势可以通过以下图直观的看出。

\begin{figure}[!h]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[height=3cm]{figures/p2_1.eps}\\
\caption{p范数与稀疏性的关系}
\end{figure}

从图中中可以直观看出，当$p\le1$时解有更大的几率落在坐标轴上，从而导致另一些分量为0，即解更趋于稀疏性。

在可以产生稀疏解的范数中，极端情况下$p \rightarrow 0$。向量的$l_0-$范数定义为向量中非零值的个数。此时问题表述如下：
\begin{equation}
\begin{aligned}
(P_0): & \mathop {\min }\limits_{\mathbf{x}} \mathop {\left\| {\mathbf{x}} \right\|}\nolimits_0 \\
\texttt{s}.\texttt{t}. & \quad \mathbf{b} = \mathbf{Ax}
\end{aligned}
\end{equation}

 $(P_2)$问题的解总是唯一的，但 $(P_0)$问题解的唯一性与可验证性并不容易确定。而且 $(P_2)$问题可以通过朗格朗日乘数法直接得到，但 $(P_0)$ 问题并没有有效的解法。可以使用穷举法检测 ${m \choose n}$ 种组合，但这种组合搜索问题复杂度与$m$成指数关系。事实上，已经证明了一般意义上 $(P_0)$ 问题是NP 难问题。

\section{压缩感知理论}
考虑一般的信号重建问题。对于某未知信号$\mathbf{x} \in \mathbb{C}^N$，通过某测量矩阵$\mathbf{\Phi} \in \mathbb{C}^{M\times N}$ 进行采样，得到未知信号$\mathbf{y} \in \mathbb{C}^M$的观测值 ，
\begin{equation}
\begin{aligned}
\mathbf{y = \Phi x}
\end{aligned}
\end{equation}

$\mathbf{y}$也可以看做原始信号$\mathbf{x}$在$\mathbf{\Phi}$下的线性投影，现在考虑由$\mathbf{y}$重构$\mathbf{x}$。 由于$\mathbf{y}$的维数远低于$\mathbf{x}$的维数，因此上式有无穷多个解，即无法准确重构出原始信号。
但假设原始信号$\mathbf{x}$是$K$稀疏信号，即$\mathbf{x}$中只有$K$项不为0，并且$\mathbf{y}$ 与$\mathbf{\Phi}$ 满足一定条件，理论证明，信号$\mathbf{x}$ 可以由测量值$\mathbf{y}$通过求解最优$l_0$ 范数问题得到准确重构：

\begin{equation}
\begin{aligned}
& \mathbf{\hat{x}= \arg \min{\left\|x\right\|_0}} \\
\texttt{s}.\texttt{t}. & \quad \mathbf{\Phi x = y}
\end{aligned}
\end{equation}

式中：$\left\|\bullet \right\|_0$为向量的$l_0$范数，表示向量$\mathbf{x}$中非零元素的个数。

\begin{figure}[!h]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[height=3cm]{figures/p2_2.eps}\\
\caption{稀疏向量的压缩感知原理示意图}
\end{figure}

对于非稀疏信号，如果可以在变换域内进行稀疏表示，即$\mathbf{f=\Psi x}$，$\mathbf{x}$为该信号在变换域$\mathbf{\Psi}$ 的稀疏表示。对于测量公式$\mathbf{y=\Phi f}$，有

\begin{equation}
\mathbf{y = \Phi f = \Phi \Psi x = Ax}
\end{equation}

式中：$\mathbf{A=\Phi\Psi}$为 $M \times N$维矩阵，成为感知矩阵。如下图所示

\begin{figure}[!h]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[height=3cm]{figures/p2_3.eps}\\
\caption{可稀疏表示向量的压缩感知原理示意图}
\end{figure}

\section{稀疏解的唯一性}

在压缩感知框架下，稀疏信号正确从压缩的样本中重建，测量矩阵需要满足一定条件。目前常用的主要有3种条件：零空间特性、约束等距性和矩阵相干度分析。

\subsection{约束等距条件（RIP）}

RIP定义为对于任意的$k=1,2,3,...,K$，定义矩阵$\Phi$的等距常量（RIC）$\delta_K$为满足下式的最小值：

\begin{equation}
(1-\delta_K)\left\|\mathbf{a} \right\|_2^2 \le \left\| \mathbf{Ta} \right\|_2^2 \le (1+\delta_K)\left\|\mathbf{a} \right\|_2^2
\end{equation}

式中：$\mathbf{a}$为任意矢量，$0 < \delta_K < 1$称矩阵$\Phi$满足$K$阶RIP条件。

对于两个具有相同稀疏度的不同信号，$\Phi$的RIP特性可以保持两者间的距离在观测空间的不变。而随机采样，有很高可能满足条件。
但验证矩阵是否满足RIP条件，需要尝试所有向量，并不实用。

\subsection{矩阵相关系数}

对于矩阵$\mathbf{T}$，矩阵相关系数$\mu (\mathbf{T})$定义为矩阵中任意两列的相关系数中的最大值：

\begin{equation}
\mu ({\bf{T}}) = \mathop {\max }\limits_{1 \le i,j \le N,i \ne j} \frac{{\left| {\tau _i^H{\tau _j}} \right|}}{{\left\| {{\tau _i}} \right\| \cdot \left\| {{\tau _j}} \right\|}}
\end{equation}

已有研究表明，矩阵相关系数$\mu (\mathbf{T})$越小，从测量信号恢复出原始信号的概率越大。

\section{压缩感知恢复算法}
OMP算法

\section{使用压缩感知进行双选信道信道估计}

第\ref{sec_ofdm}节讨论的OFDM系统为离散系统，将物理信道，脉冲成型等等效为离散信道。使用压缩感知理论进行信道估计的基础是信道是可稀疏表示的，因此下面从更一般的多载波系统分析双选信道的特性。

\subsection{多载波系统}
下图是一个多载波系统框图，包括子载波调制，内插滤波器，物理信道，抗混叠滤波器，子载波解调5部分。系统输入为星座映射后的符号，输出为接收符号。
\begin{figure}[!h] \label{p_mc}
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[height=5cm]{figures/mc_system.eps}\\
\caption{多载波系统框图}
\end{figure}

假设系统的子载波个数为$K$，添加CP后OFDM符号长度为$N$，则CP长度为$N-K$。每个OFDM帧中包含符号数为$L$。

子载波调制器输出的离散信号为

\begin{equation}
s[n] = \sum\limits_{l = 0}^{L-1} \sum\limits_{k = 0}^{K-1} a_{l,k}g_{l,k}[n]
\end{equation}

式中输入符号$a_{l,k}$下标表示第$l$个符号和第$k$个子载波，$g[n]$是发送脉冲，
\begin{equation}
g\left[ n \right] = \left\{ \begin{array}{l}
1,0 \le n \le N - 1\\
0,{\rm{otherwise}}
\end{array} \right.
\end{equation}

$g_{l,k}[n]$是第$l$个符号和第$k$个子载波对应的子载波调制形式，定义如下
\begin{equation}
{g_{l,k}}[n]\mathop {\rm{ = }}\limits^\Delta  g[n-lN]e^{j2\pi k(n-lN)/K}
\end{equation}

离散信号$s[n]$通过内插滤波器成为连续信号$s(t)$
\begin{equation}
s(t) = \sum\limits_{n = -\infty}^{\infty} s[n]f(t-nT_{s})
\end{equation}

$f(t)$为插值滤波器，$T_s$为采样间隔。假设$f(t)$为理想滤波器

\begin{equation}
f(t) = \frac{1}{\sqrt{T_s}}sinc(\pi t/T_s)
\end{equation}

对于双选信道，信道时变脉冲响应为$h(t,\tau)$,时域噪声为$z(t)$，信道输出为

\begin{equation}
r(t) = \int_{ - \infty }^\infty  h(t,\tau)s(t-\tau)d\tau + z(t)
\end{equation}

经过抗混叠滤波器后，得到离散信号
\begin{equation}
r[n] = \int_{ - \infty }^\infty  r(t)f(t-nT_s)dt
\end{equation}

多载波解调时，将接受序列与接收脉冲$\gamma[n]$做内积，得到接收符号
\begin{equation}
x_{l,k} = \langle r,\gamma_{l,k} \rangle = \sum\limits_{n = -\infty}^{\infty} r[n]\gamma_{l,k}^{*}[n]
\end{equation}

发送脉冲$g[n]$对应的$\gamma[n]$定义为
\begin{equation}
\gamma \left[ n \right] = \left\{ \begin{array}{l}
1,N-K \le n \le N - 1\\
0,{\rm{otherwise}}
\end{array} \right.
\end{equation}

同多载波调制，$\gamma_{l,k}$为$l$和$k$对应的偏移形式
\begin{equation}
{\gamma_{l,k}}[n]\mathop {\rm{ = }}\limits^\Delta  \gamma[n-lN]e^{j2\pi k(n-lN)/K}
\end{equation}

将图\ref{p_mc}中，内插滤波器，物理信道，抗混叠滤波器等效为离散信道$h[n,m]$，即在第\ref{sec_tau_t}定义的双选信道时变脉冲响应的离散形式
\begin{equation} \label{eq3_19}
h[n,m] = \int_{ - \infty }^\infty  n(nT_s,\tau)sinc(\pi(m-\frac{\tau}{T_s}))d\tau
\end{equation}

式中，通过$T_s$为间隔的采样，时间$t$变为离散序列下标$n$，时延$\tau$变为离散时延$m$, 则物理信道的输入/输出关系可以改写为类似式(\ref{eq2_19}) 的离散形式
\begin{equation} \label{eq3_20}
r[n] =\sum\limits_{m = -\infty}^{\infty} h[n,m]s[n-m] +z[n]
\end{equation}

\subsection{多载波系统等效系统信道}

上一节我们将内插滤波器，抗混叠滤波器和物理信道结合，得到了离散信道。这一节我们推导包含子载波调制、解调在内的多载波系统等效系统信道$H_{l,k}$。

首先，从图\ref{p_mc}中可得到系统信道的输入/输出关系
\begin{equation}
x_{l,k} = H_{l,k}a_{l,k} + z_{l,k}
\end{equation}

在第\ref{sec_tau_nu}节我们定义了双选信道的时延-多普勒域-扩展函数$S_h[\tau,\nu]$，并在第\ref{sec_tau_t}中推导了它与时变脉冲响应$h(t,\tau)$之间的关系。这里我们定义离散-时延-多普勒域-扩展函数$S_h[m,i]$

\begin{equation} \label{eq3_22}
{S_h}\left[ {m,i} \right]\mathop  = \limits^\Delta \frac{1}{NL} \sum\limits_{n = 0}^{NL} h[n,m]e^{-j2\pi in/NL}
\end{equation}

式中，$i$表示离散多普绿频移。利用$S_h[m,i]$可以改写式\ref{eq3_20}为

\begin{equation}
r[n] = \sum\limits_{m = -\infty}^{\infty} \sum\limits_{i=0}^{NL-1}S_h[m,i]s[n,m]e^{j2\pi in/NL}+z[n]
\end{equation}

至此，我们可以得到多载波系统等效的信道$H_{l,k}$，第\ref{sec_tf}节我们得到了时频域传递函数$L_H(t,f)$，这里为其对应的离散形式

\begin{equation} \label{eq3_24}
H_{l,k} = \sum\limits_{m = 0}^{K-1} \sum\limits_{i=0}^{L-1} F[m,i]e^{-j2\pi(\frac{km}{K}-\frac{li}{L})}
\end{equation}

\begin{equation}
F[m,i]\mathop  = \limits^\Delta S_h[m,i]A_{\gamma,g}^*(m,\frac{i}{N_r})
\end{equation}


式中,$A_{\gamma,g}(m,\xi)$成为互模糊函数，由发送脉冲$g[n]$和接收脉冲$\gamma[n]$决定，定义如下

\begin{equation}
A_{\gamma,g}[m,\xi] \mathop = \limits^\Delta \sum\limits_{n=-\infty}^{\infty} \gamma[n]g^*[n-m]e^{-j2\pi \xi n}
\end{equation}

至此，我们使用LTV信道模型得到了将包括多载波调制/解调在内的多载波系统等效信道$H_{l,k}$。

假设物理信道包含$P$条径，对应时延为$\tau_p$，多普勒频移为$\nu_p$，则信道时变脉冲响应如式(\ref{eq2_15})所示，代入式(\ref{eq3_19}) 得到离散时变脉冲响应

\begin{equation}
h[n,m] = \sum\limits_{p=1}^P h_p e^{j2\pi \nu_p nT_s} sinc(\pi(m-\frac{\tau}{T_s}))
\end{equation}

将上式代入式(\ref{eq3_22})的离散-时延-时延-多普勒域扩展函数得到
\begin{equation} \label{eq3_22}
{S_h}\left[ {m,i} \right]\mathop  = \limits^\Delta \sum\limits_{p = 1}^{P} h_pe^{j\pi(\nu_pT_s-\frac{i}{NL}(NL-1))}\Lambda_p[m,i]
\end{equation}

式中，
\begin{equation} \label{eq3_22}
\Lambda_p[m,i] \mathop = \limits^\Delta sinc(\pi(m-\frac{\tau_p}{T_s}))dir_{NL}(\pi(i-\nu_pT_sNL))
\end{equation}

\begin{equation} \label{eq3_22}
dir_N(x) \mathop = \limits^\Delta \frac{1}{N}e^{jx(N-1)/N} \sum\limits_{n = 0}^{N-1} e^{-j2xn/N} = \frac{x}{Nsin(x/N)}
\end{equation}

对$\Lambda_p[m,i]$分析可知，其为近似稀疏信号,假设稀疏度为$N_\Lambda$，则$S_h[m,i]$也为稀疏信号，稀疏度为$PN_\lambda$，则双选信道对应的离散-时延-多普勒函数$F[m,i]$也为$PN_\Lambda$稀疏，因此可以适用于压缩感知框架。

\subsection{压缩感知信道估计}
从上一节的分析可知，双选信道在时延-多普勒域可以稀疏表示，下面将信道表达式(\ref{eq3_24})改写为符合压缩感知框架的形式
\begin{equation} \label{eq3_22}
H = \sum\limits_{m = 0}^{K-1} \sum\limits_{i=0}^{L-1} \alpha_{m,i}U_{m,i} = \mathbf{U \alpha}
\end{equation}

上式为式(\ref{eq3_24})对应的矩阵形式，其中$\mathbf{U}$为二维傅里叶变换矩阵

\begin{equation} \label{eq3_22}
\alpha_{m,i} = \sqrt{NL}F[m,i], \quad U_{m,i} = \frac{1}{\sqrt{NL}}e^{-j2\pi (\frac{km}{K}-\frac{li}{L})}
\end{equation}

假设导频选取矩阵为$\mathbf{S}$。压缩感知中一般使用随机导频，可通过随机选取$NL$维单位阵的行向量组成。则导频处的接收符号满足

\begin{equation} \label{eq3_33}
H_p = \mathbf{SU\alpha}
\end{equation}

上式中，使用导频处的信道估计值$\hat{H_p}$代替$H_p$，则只有$\mathbf{\alpha}$为未知量。由之前的分析可知$\mathbf{\alpha}$为稀疏信号，通过恢复算法可以得到$\mathbf{\alpha}$的估计值$\hat{\mathbf{\alpha}}$，再由式(\ref{eq3_24})得到信道的估计值。


