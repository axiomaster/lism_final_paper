
\chapter{改善压缩感知信道估计的方法}


\section{过采样技术}



\section{改进导频设计}

在第\ref{sec2_-5_1}节，我们得到了双选信道下信道估计的压缩感知形式

\begin{equation}
\hat{H_p} = \mathbf{SU\alpha}
\end{equation}

式中，$\hat{H_p}$为导频处的信道估计值，在压缩感知信道估计前已经得到；$\mathbf{U}$为二维傅里叶变换矩阵，为确定值；$\alpha$ 为待估计值；$\mathbf{S}$为导频选取矩阵。在压缩感知框架下，传感矩阵$\mathbf{T = SU}$。由\ref{2_4_3} 节分析可知，压缩感知估计的效果由测量矩阵$\mathbf{T}$的性质决定，而测量矩阵由导频选取矩阵$\mathbf{S}$决定。

\subsection{等间隔导频}

在\ref{sec2_3_1}节所示的传统信道估计方法中，等间隔导频已被证明具有最好的估计性能。下面我们证明等间隔导频并不适用于压缩感知信道估计。

假设$\mathbf{W}$是$N$维傅里叶变换矩阵，则

\begin{equation}
{\bf{W}} = \left[ {\begin{array}{*{20}{c}}
1&1&1& \cdots &1\\
1&w&{{w^2}}& \cdots &{{w^{N - 1}}}\\
1&{{w^2}}&{{w^4}}& \cdots &{{w^{2\left( {N - 1} \right)}}}\\
 \vdots & \vdots & \vdots & \ddots & \vdots \\
1&{{w^{N - 1}}}&{{w^{2\left( {N - 1} \right)}}}& \cdots &{{w^{\left( {N - 1} \right)\left( {N - 1} \right)}}}
\end{array}} \right]
\end{equation}

式中$w = \frac{1}{\sqrt{N}}e^{-j2\pi /N}$

假定等均匀导频间隔为$q$，且可以被$N$整除，所以有$N=Pq$。为了方便公式推导，我们假设起始导频从1开始，所以传感矩阵$\mathbf{T}$为

\begin{equation}
{\bf{T = SW}} = \left[ {\begin{array}{*{20}{c}}
1&w&{{w^2}}& \cdots &{{w^{N - 1}}}\\
1&{{w^q}}&{{w^{2q}}}& \cdots &{{w^{\left( {N - 1} \right)q}}}\\
1&{{w^{2q}}}&{{w^{4q}}}& \cdots &{{w^{2\left( {N - 1} \right)q}}}\\
 \vdots & \vdots & \vdots & \ddots & \vdots \\
1&{{w^{\left( {P - 1} \right)q}}}&{{w^{2\left( {P - 1} \right)q}}}& \cdots &{{w^{\left( {N - 1} \right)\left( {P - 1} \right)q}}}
\end{array}} \right]
\end{equation}

则矩阵中第$i+1$列和第$i+1+P$列为
\begin{equation}
{\tau _{i + 1}} = \left[ {\begin{array}{*{20}{c}}
w\\
{{w^{iq}}}\\
{{w^{2iq}}}\\
 \vdots \\
{{w^{\left( {P - 1} \right)iq}}}
\end{array}} \right]
， \quad
{\tau _{i + 1 + P}} = \left[ {\begin{array}{*{20}{c}}
w\\
{{w^{\left( {i + P} \right)q}}}\\
{{w^{2\left( {i + P} \right)q}}}\\
 \vdots \\
{{w^{\left( {P - 1} \right)\left( {i + P} \right)q}}}
\end{array}} \right] = \left[ {\begin{array}{*{20}{c}}
w\\
{{w^{iq}} \cdot {w^{Pq}}}\\
{{w^{2iq}} \cdot {w^{2Pq}}}\\
 \vdots \\
{{w^{\left( {P - 1} \right)iq}} \cdot {w^{\left( {P - 1} \right)Pq}}}
\end{array}} \right]
\end{equation}
因为$N=Pq$，所以$w^{Pq} = 1$，所以$\tau_{i+1} = \tau{i+1+P}$，即相差为P的列完全相关。所以矩阵相关系数$\mu(\mathbf{T})=1$。

对于非整除情况，第$i$列与周期附近的列强相关，相关系数也很大。从第\ref{2_4_3}节的分析可知，均匀导频不适用于压缩感知信道估计。

\subsection{现有导频优化准则的不足}

上节分析了传统估计方法中最优的等间距导频，证明其不适用于压缩感知信道估计。

根据压缩感知理论，随机导频可以大概率满足约束等距条件，因此也是日常使用最多的导频方式。但在实际中，需要固定导频图案，而且随机导频的性能具有不确定性，需要做导频优化。

目前在压缩感知中，使用最多的导频优化方案，就是最小化测量矩阵的互相关系数。但测量矩阵的互相关系数，与信道估计性能，并没有单调相关性。仿真结果如下：

\begin{figure}[!h]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[height=7cm]{figures/p3_1_1.eps}\\
\caption{$\mu(\mathbf{T}$)与估计性能的关系}
\end{figure}

随机生成50个矩阵互相关系数不同的导频图案，图中每个点代表一个导频图案。通过仿真，得到[5 10 15 20]dB处的信道估计MSE性能，取平均后得到平均MSE，为图中纵轴。

从图中可以看出，相关系数 与MSE具有正相关特性，但不具有单调性。因此，具有更小 的导频相比更大 的导频并不一定具有更好的MSE性能。因此，使用 导频优化准则，在有限的仿真内，并不一定能得到最好的导频。

\subsection{对导频优化准则的评价标准}

在找到理想的导频优化准则之前，可以猜想理想导频具有的特性。好的导频优化准则，它的特性可以在仿真前指示出导频的信道估计性能，最好与信道估计性能具有单调性关系。归一化均方误差可以描述这种趋势。

归一化均方误差定义如下：

\begin{equation}
NMSE\left( y \right) = 10{\log _{10}}\frac{{\sum\limits_{i = 1}^n {{{\left| {f\left( x \right) - y} \right|}^2}} }}{{\sum\limits_{i = 1}^n {{{\left| {f\left( x \right)} \right|}^2}} }}
\end{equation}

$f(x)$是真值，y是真值的估计值。

在导频设计中，真值的函数并不确定，可以使用拟合函数来代替。NMSE值越小，说明准则单调性越好，因此设计的导频越好。
\begin{figure}[!h]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[height=7cm]{figures/p3_2_1.eps}\\
\caption{多载波系统框图}
\end{figure}

图中包含5000个点，每个点代表一个导频图案。图中黑线是所有点的拟合结果。仿真图显示了导频图案相对拟合结果的离散性。

多项式拟合中，多项式阶数越高，拟合的准确性越好。但使用4次多项式，能够可以看到明显的过拟合现象，因此图中使用3次多项式拟合。

图中拟合的函数为$f\left( x \right) =  - 8.56{e^{ - 4}}{x^3} + 8.7{e^{ - 4}}{x^2} + 1.7{e^{ - 4}}x + 8.9{e^{ - 5}}$。将$\mu(\mathbf{T})$作为$x$值，MSE作为$y$值代入NMSE中，计算的其值为-15.0381。

\subsection{基于最大特征值的导频优化准则}

矩阵互相关系数定义为测量矩阵中，列相关系数的最大值。因此矩阵互相关系数并没有表征出矩阵的所有特征。但矩阵特征值可以。

测量矩阵$bf{T}$并不是方阵，因此不存在特征值，可以使用Gram矩阵。Gram矩阵定义为$bf{G=T^{H}T}$，则Gram矩阵为对称矩阵，矩阵中所有元素均为$\bf{T}$的列相关系数。

\begin{figure}[!h]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[height=7cm]{figures/p3_3_1.eps}\\
\caption{多载波系统框图}
\end{figure}

上图的拟合函数为$f\left( x \right) = 1.7{e^{ - 4}}{x^3} - 3.7{e^{ - 4}}{x^2} + 3.0{e^{ - 4}}x - 7.0{e^{ - 5}}$，将$\lambda_{max}$代入NSME定义式中，得到NMSE值为-19.5372，这个值比基于$\mu(\bf(T))$的值小，最小化最大特征值比最小化$\mu(\bf(T))$准则更好。

\subsection{基于特征值方差的导频优化准则}

Gram矩阵为对称矩阵，对角线元素为测量矩阵T的列自相关系数，所以都为1.特征值平方和也为定值，$\sum {{\lambda _i} = tr\left( {{G^2}} \right)} $。

因此，可以推断特征值的分布特性与MSE性能的关系。
\begin{figure}[!h]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[height=7cm]{figures/p3_4_1.eps}\\
\caption{多载波系统框图}
\end{figure}

上图中，拟合函数为$f\left( x \right) =  - 8.3{e^{ - 4}}{x^3} - 1.0{e^{ - 4}}{x^2} - 1.7{e^{ - 4}}x + 2.3{e^{ - 5}}$，代入NMSE中可得NMSE值为-22.9435.所以使用特征值方差，要好于矩阵互相关系数和最大特征值。

\section{改善基}

\subsection{多载波系统}
下图是一个多载波系统框图，包括子载波调制，内插滤波器，物理信道，抗混叠滤波器，子载波解调5部分。系统输入为星座映射后的符号，输出为接收符号。
\begin{figure}[!h] \label{p_mc}
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[height=5cm]{figures/mc_system.eps}\\
\caption{多载波系统框图}
\end{figure}

假设系统的子载波个数为$K$，添加CP后OFDM符号长度为$N$，则CP长度为$N-K$。每个OFDM帧中包含符号数为$L$。

子载波调制器输出的离散信号为

\begin{equation}
s[n] = \sum\limits_{l = 0}^{L-1} \sum\limits_{k = 0}^{K-1} a_{l,k}g_{l,k}[n]
\end{equation}

式中输入符号$a_{l,k}$下标表示第$l$个符号和第$k$个子载波，$g[n]$是发送脉冲，
\begin{equation}
g\left[ n \right] = \left\{ \begin{array}{l}
1,0 \le n \le N - 1\\
0,{\rm{otherwise}}
\end{array} \right.
\end{equation}

$g_{l,k}[n]$是第$l$个符号和第$k$个子载波对应的子载波调制形式，定义如下
\begin{equation}
{g_{l,k}}[n]\mathop {\rm{ = }}\limits^\Delta  g[n-lN]e^{j2\pi k(n-lN)/K}
\end{equation}

离散信号$s[n]$通过内插滤波器成为连续信号$s(t)$
\begin{equation}
s(t) = \sum\limits_{n = -\infty}^{\infty} s[n]f(t-nT_{s})
\end{equation}

$f(t)$为插值滤波器，$T_s$为采样间隔。假设$f(t)$为理想滤波器

\begin{equation}
f(t) = \frac{1}{\sqrt{T_s}}sinc(\pi t/T_s)
\end{equation}

对于双选信道，信道时变脉冲响应为$h(t,\tau)$,时域噪声为$z(t)$，信道输出为

\begin{equation}
r(t) = \int_{ - \infty }^\infty  h(t,\tau)s(t-\tau)d\tau + z(t)
\end{equation}

经过抗混叠滤波器后，得到离散信号
\begin{equation}
r[n] = \int_{ - \infty }^\infty  r(t)f(t-nT_s)dt
\end{equation}

多载波解调时，将接受序列与接收脉冲$\gamma[n]$做内积，得到接收符号
\begin{equation}
x_{l,k} = \langle r,\gamma_{l,k} \rangle = \sum\limits_{n = -\infty}^{\infty} r[n]\gamma_{l,k}^{*}[n]
\end{equation}

发送脉冲$g[n]$对应的$\gamma[n]$定义为
\begin{equation}
\gamma \left[ n \right] = \left\{ \begin{array}{l}
1,N-K \le n \le N - 1\\
0,{\rm{otherwise}}
\end{array} \right.
\end{equation}

同多载波调制，$\gamma_{l,k}$为$l$和$k$对应的偏移形式
\begin{equation}
{\gamma_{l,k}}[n]\mathop {\rm{ = }}\limits^\Delta  \gamma[n-lN]e^{j2\pi k(n-lN)/K}
\end{equation}

将图\ref{p_mc}中，内插滤波器，物理信道，抗混叠滤波器等效为离散信道$h[n,m]$，即在第\ref{sec_tau_t}定义的双选信道时变脉冲响应的离散形式
\begin{equation} \label{eq3_19}
h[n,m] = \int_{ - \infty }^\infty  n(nT_s,\tau)sinc(\pi(m-\frac{\tau}{T_s}))d\tau
\end{equation}

式中，通过$T_s$为间隔的采样，时间$t$变为离散序列下标$n$，时延$\tau$变为离散时延$m$, 则物理信道的输入/输出关系可以改写为类似式(\ref{eq2_19}) 的离散形式
\begin{equation} \label{eq3_20}
r[n] =\sum\limits_{m = -\infty}^{\infty} h[n,m]s[n-m] +z[n]
\end{equation}

\subsection{多载波系统等效系统信道}

上一节我们将内插滤波器，抗混叠滤波器和物理信道结合，得到了离散信道。这一节我们推导包含子载波调制、解调在内的多载波系统等效系统信道$H_{l,k}$。

首先，从图\ref{p_mc}中可得到系统信道的输入/输出关系
\begin{equation}
x_{l,k} = H_{l,k}a_{l,k} + z_{l,k}
\end{equation}

在第\ref{sec_tau_nu}节我们定义了双选信道的时延-多普勒域-扩展函数$S_h[\tau,\nu]$，并在第\ref{sec_tau_t}中推导了它与时变脉冲响应$h(t,\tau)$ 之间的关系。这里我们定义离散-时延-多普勒域-扩展函数$S_h[m,i]$

\begin{equation} \label{eq3_22}
{S_h}\left[ {m,i} \right]\mathop  = \limits^\Delta \frac{1}{NL} \sum\limits_{n = 0}^{NL} h[n,m]e^{-j2\pi in/NL}
\end{equation}

式中，$i$表示离散多普绿频移。利用$S_h[m,i]$可以改写式\ref{eq3_20}为

\begin{equation}
r[n] = \sum\limits_{m = -\infty}^{\infty} \sum\limits_{i=0}^{NL-1}S_h[m,i]s[n,m]e^{j2\pi in/NL}+z[n]
\end{equation}

至此，我们可以得到多载波系统等效的信道$H_{l,k}$，第\ref{sec_tf}节我们得到了时频域传递函数$L_H(t,f)$，这里为其对应的离散形式

\begin{equation} \label{eq3_24}
H_{l,k} = \sum\limits_{m = 0}^{K-1} \sum\limits_{i=0}^{L-1} F[m,i]e^{-j2\pi(\frac{km}{K}-\frac{li}{L})}
\end{equation}

\begin{equation}
F[m,i]\mathop  = \limits^\Delta S_h[m,i]A_{\gamma,g}^*(m,\frac{i}{N_r})
\end{equation}


式中,$A_{\gamma,g}(m,\xi)$成为互模糊函数，由发送脉冲$g[n]$和接收脉冲$\gamma[n]$决定，定义如下

\begin{equation}
A_{\gamma,g}[m,\xi] \mathop = \limits^\Delta \sum\limits_{n=-\infty}^{\infty} \gamma[n]g^*[n-m]e^{-j2\pi \xi n}
\end{equation}

至此，我们使用LTV信道模型得到了将包括多载波调制/解调在内的多载波系统等效信道$H_{l,k}$。

假设物理信道包含$P$条径，对应时延为$\tau_p$，多普勒频移为$\nu_p$，则信道时变脉冲响应如式(\ref{eq2_15})所示，代入式(\ref{eq3_19}) 得到离散时变脉冲响应

\begin{equation}
h[n,m] = \sum\limits_{p=1}^P h_p e^{j2\pi \nu_p nT_s} sinc(\pi(m-\frac{\tau}{T_s}))
\end{equation}

将上式代入式(\ref{eq3_22})的离散-时延-时延-多普勒域扩展函数得到
\begin{equation} \label{eq3_22}
{S_h}\left[ {m,i} \right]\mathop  = \limits^\Delta \sum\limits_{p = 1}^{P} h_pe^{j\pi(\nu_pT_s-\frac{i}{NL}(NL-1))}\Lambda_p[m,i]
\end{equation}

式中，
\begin{equation} \label{eq3_22}
\Lambda_p[m,i] \mathop = \limits^\Delta sinc(\pi(m-\frac{\tau_p}{T_s}))dir_{NL}(\pi(i-\nu_pT_sNL))
\end{equation}

\begin{equation} \label{eq3_22}
dir_N(x) \mathop = \limits^\Delta \frac{1}{N}e^{jx(N-1)/N} \sum\limits_{n = 0}^{N-1} e^{-j2xn/N} = \frac{x}{Nsin(x/N)}
\end{equation}

对$\Lambda_p[m,i]$分析可知，其为近似稀疏信号,假设稀疏度为$N_\Lambda$，则$S_h[m,i]$也为稀疏信号，稀疏度为$PN_\lambda$，则双选信道对应的离散-时延-多普勒函数$F[m,i]$也为$PN_\Lambda$稀疏，因此可以适用于压缩感知框架。


